1.
SELECT plate
FROM car
WHERE plate LIKE 'AN%' AND color = 'red'


2.
[for each given_hour]
SELECT COUNT(*)
FROM charging_station INNER JOIN car_uses_charging_station ON charging_station.sid = car_uses_charging_station.sid
WHERE start_time = '[given_date]%' AND
 (SELECT DATEPART(HOUR, (SELECT DATEADD(minute, charging_time)))) > ([given_hour]) AND
 (SELECT DATEPART(HOUR, start_time)) < ([given_hour] + 1)


3.



4.
SELECT customer_username, start_time, cost
FROM customer_uses_car
WHERE customer_username = [given_name]
GROUP BY start_time
HAVING count(*) > 1


5.
SELECT AVG(distance)
FROM customer_uses_car
WHERE start_time = [given_date] AND type = 'order'

SELECT AVG(duration)
FROM customer_uses_car
WHERE start_time = [given_date] AND type = 'trip'


6.
SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'trip' AND (SELECT DATEPART(HOUR, start_time)) > 7 AND (SELECT DATEPART(HOUR, start_time)) < 10
)
ORDER BY c

SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'trip' AND (SELECT DATEPART(HOUR, start_time)) > 12 AND (SELECT DATEPART(HOUR, start_time)) < 14
)
ORDER BY c

SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'trip' AND (SELECT DATEPART(HOUR, start_time)) > 17 AND (SELECT DATEPART(HOUR, start_time)) < 19
)
ORDER BY c

SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'order' AND (SELECT DATEPART(HOUR, start_time)) > 7 AND (SELECT DATEPART(HOUR, start_time)) < 10
)
ORDER BY c

SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'order' AND (SELECT DATEPART(HOUR, start_time)) > 12 AND (SELECT DATEPART(HOUR, start_time)) < 14
)
ORDER BY c

SELECT TOP 3 destination, c
FROM (SELECT destination, COUNT (*)
FROM customer_uses_car
WHERE type = 'order' AND (SELECT DATEPART(HOUR, start_time)) > 17 AND (SELECT DATEPART(HOUR, start_time)) < 19
)
ORDER BY c


7.
SELECT TOP 10 PERCENT car
FROM (
	SELECT car, count(*) as c
	FROM customer_uses_car
	WHERE (SELECT DATEADD(month, start_time)) > (SELECT GETDATE())
	GROUP BY car
)
ORDER BY c ASC


8.


9. 


10.
SELECT plate
FROM car
WHERE
(SELECT AVG(
	SELECT cost
	FROM charging_station INNER JOIN car_uses_charging_station ON charging_station.sid = car_uses_charging_station.sid

	UNION ALL

	SELECT price * count AS cost
	FROM car_part INNER JOIN workshop_repaired_car ON car_part.name = workshop_repaired_car.pname
)) = (SELECT MAX(
	SELECT AVG(
		SELECT cost
		FROM charging_station INNER JOIN car_uses_charging_station ON charging_station.sid = car_uses_charging_station.sid
		WHERE car_uses_charging_station.plate = car.plate

		UNION ALL

		SELECT price * count AS cost
		FROM car_part INNER JOIN workshop_repaired_car ON car_part.name = workshop_repaired_car.pname
	))
)