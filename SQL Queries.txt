1.
SELECT plate
FROM car
WHERE plate LIKE 'AN%' AND color = 'Red'


2.
[for each given_hour (0-23)]
SELECT COUNT(*) FROM car_uses_charging_station
WHERE date(start_time) = date('[given_date]') AND CAST(strftime('%H', start_time) AS INTEGER) < [given_hour] + 1 AND
CAST(strftime('%H', end_time) AS INTEGER) > [given_hour]


3.
SELECT 100 * ((
	SELECT COUNT(*)
	FROM customer_uses_car
	WHERE datetime(start_time, '+7 day') > datetime('now') AND
	 CAST(strftime('%H', start_time) AS INTEGER) > 7 AND
	 CAST(strftime('%H', start_time) AS INTEGER) < 10
) * 1.0) / ((SELECT COUNT(*) FROM car) * 7.0)

SELECT 100 * ((
	SELECT COUNT(*)
	FROM customer_uses_car
	WHERE datetime(start_time, '+7 day') > datetime('now') AND
	 CAST(strftime('%H', start_time) AS INTEGER) > 12 AND
	 CAST(strftime('%H', start_time) AS INTEGER) < 14
) * 1.0) / ((SELECT COUNT(*) FROM car) * 7.0)

SELECT 100 * ((
	SELECT COUNT(*)
	FROM customer_uses_car
	WHERE datetime(start_time, '+7 day') > datetime('now') AND
	 CAST(strftime('%H', start_time) AS INTEGER) > 17 AND
	 CAST(strftime('%H', start_time) AS INTEGER) < 19
) * 1.0) / ((SELECT COUNT(*) FROM car) * 7.0)


4.
SELECT customer_username, start_time, cost
FROM customer_uses_car
WHERE customer_username = [given_name]
GROUP BY start_time
HAVING COUNT(*) > 1


5.
SELECT AVG(distance)
FROM customer_uses_car
WHERE date(start_time) = date('[given_date]') AND type = 'order'

SELECT AVG(duration)
FROM customer_uses_car
WHERE date(start_time) = date('[given_date]') AND type = 'trip'


6.
SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'trip' AND CAST(strftime('%H', start_time) AS INTEGER) > 7 AND CAST(strftime('%H', start_time) AS INTEGER) < 10
	GROUP BY destination
)
ORDER BY c
LIMIT 3

SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'trip' AND CAST(strftime('%H', start_time) AS INTEGER) > 12 AND CAST(strftime('%H', start_time) AS INTEGER) < 14
	GROUP BY destination
)
ORDER BY c
LIMIT 3

SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'trip' AND CAST(strftime('%H', start_time) AS INTEGER) > 17 AND CAST(strftime('%H', start_time) AS INTEGER) < 19
	GROUP BY destination
)
ORDER BY c
LIMIT 3

SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'order' AND CAST(strftime('%H', start_time) AS INTEGER) > 7 AND CAST(strftime('%H', start_time) AS INTEGER) < 10
	GROUP BY destination
)
ORDER BY c
LIMIT 3

SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'order' AND CAST(strftime('%H', start_time) AS INTEGER) > 12 AND CAST(strftime('%H', start_time) AS INTEGER) < 14
	GROUP BY destination
)
ORDER BY c
LIMIT 3

SELECT destination, c
FROM (
	SELECT destination, COUNT (*) AS c
	FROM customer_uses_car
	WHERE type = 'order' AND CAST(strftime('%H', start_time) AS INTEGER) > 17 AND CAST(strftime('%H', start_time) AS INTEGER) < 19
	GROUP BY destination
)
ORDER BY c
LIMIT 3


7.
SELECT car, c
FROM (
	SELECT car, count(*) as c
	FROM customer_uses_car
	WHERE datetime(start_time, '+3 month') > datetime('now')
	GROUP BY car
)
ORDER BY c ASC
LIMIT (SELECT (SELECT COUNT(*) FROM car) / 10)


8.
SELECT customer, COUNT(*) AS charges
FROM (
	SELECT customer_uses_car.car, customer_uses_car.customer, customer_uses_car.start_time
	FROM customer_uses_car INNER JOIN car_uses_charging_station ON customer_uses_car.car = car_uses_charging_station.plate
	WHERE strftime('%m', car_uses_charging_station.start_time) = strftime('%m', customer_uses_car.start_time)
)
GROUP BY customer
ORDER BY charges


9. 
SELECT wid, pname, c
FROM (
    SELECT wid, pname, (SELECT CAST (strftime('%Y', start_time) AS INTEGER) * 53 + CAST (strftime('%W', start_time) AS INTEGER)) AS week, COUNT (*) AS c
    FROM workshop_repaired_car
    GROUP BY week
    ORDER BY c DESC
	LIMIT 1
)


10.
SELECT plate, AVG(cost) as cost
FROM (
	SELECT car_uses_charging_station.plate, charging_station.cost
	FROM charging_station INNER JOIN car_uses_charging_station ON charging_station.sid = car_uses_charging_station.sid
	UNION ALL
	SELECT workshop_repaired_car.plate, car_part.price AS cost
	FROM car_part INNER JOIN workshop_repaired_car ON car_part.name = workshop_repaired_car.pname
	GROUP BY plate
)
ORDER BY cost DESC
LIMIT 1